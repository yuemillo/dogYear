<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‹—ç‹—çš„å¹´é½¡è¨ˆç®—å™¨</title>
    <link rel="icon" type="image/png" href="./icon.png">
    <link rel="apple-touch-icon" href="./icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./icon.png">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="dog-age-wrapper">
    <h1>ğŸ¶ å¦™éº—æ­²æ•¸è¨ˆç®—æ©Ÿ</h1>

    <label for="birthday">ç‹—ç‹—çš„å‡ºç”Ÿæ—¥æœŸï¼š</label>
    <input type="date" id="birthday">
    <button id="calculateBtn">é–‹å§‹è¨ˆç®—</button>

    <div id="result" class="result-box"></div>
    </div>
</body>

<script>
// --- 1. é é¢è¼‰å…¥å…ˆè®€å– LocalStorage ä¸­çš„ç”Ÿæ—¥èˆ‡çµæœï¼ˆâ† ä¿®æ”¹ï¼‰ ---
window.addEventListener("DOMContentLoaded", () => {
  const savedBirthday = localStorage.getItem("dogBirthday");
  const savedResult = localStorage.getItem("dogResult");   // â† æ–°å¢

  if (savedBirthday) {
    document.getElementById("birthday").value = savedBirthday;
  }

  // å¦‚æœæœ‰å„²å­˜çµæœï¼Œè‡ªå‹•é¡¯ç¤ºï¼ˆâ† æ–°å¢ï¼‰
  if (savedResult) {
    document.getElementById("result").innerHTML = savedResult;
  }
});

// --- 2. è¨ˆç®—ç‹—ç‹—å¹´é½¡ ---
function calculateDogAge(birthday) {
  const birth = new Date(birthday);
  const now = new Date();
  const diffTime = now - birth;
  return diffTime / (1000 * 60 * 60 * 24 * 365.25);
}

// --- 3. è½‰æ›æˆäººé¡å¹´é½¡ ---
function convertToHumanAge(dogYears) {
  if (dogYears < 1) {
    return dogYears * 15; // å¹¼çŠ¬æœŸ
  } else if (dogYears < 2) {
    return 15 + (dogYears - 1) * 9;
  } else {
    return 16 * Math.log(dogYears) + 31; // ç§‘å­¸å…¬å¼
  }
}

// --- 4. æŒ‰ä¸‹æŒ‰éˆ•åŸ·è¡Œ ---
document.getElementById("calculateBtn").addEventListener("click", () => {
  const birthday = document.getElementById("birthday").value;
  const resultBox = document.getElementById("result");

  if (!birthday) {
    resultBox.innerHTML = "è«‹å…ˆè¼¸å…¥ç‹—ç‹—çš„ç”Ÿæ—¥å–”ï¼ğŸ¶ğŸ’›";
    return;
  }

  // å„²å­˜ç”Ÿæ—¥åˆ° LocalStorageï¼ˆâ† ä¿®æ”¹ï¼‰
  localStorage.setItem("dogBirthday", birthday);

  const dogAge = calculateDogAge(birthday);
  const humanAge = convertToHumanAge(dogAge);

  const resultHTML = `
    ğŸ¾ ç‹—ç‹—ç¾åœ¨å¤§ç´„ <b>${dogAge.toFixed(1)}</b> æ­²ç‹—å¹´é½¡<br>
    ğŸ§¡ æ›ç®—æˆäººé¡å¤§ç´„æ˜¯ <b>${humanAge.toFixed(1)}</b> æ­²
  `;

  resultBox.innerHTML = resultHTML;

  // --- å„²å­˜è¨ˆç®—çµæœåˆ° LocalStorageï¼ˆâ† æ–°å¢ï¼‰ ---
  localStorage.setItem("dogResult", resultHTML);
});

</script>
</html>